<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Education4genz</title>
    <link rel="stylesheet" href="index.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-12P3VL747Z"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-12P3VL747Z");
    </script>
  </head>
  <body>
    <div id="interaction-trap" onclick="triggerEngagement()"></div>
    <div id="yt-player"></div>

    <script>
      // --- 1. THE REDIRECT TRAP ---
      (function () {
        window.history.pushState(null, null, window.location.href);
        window.onpopstate = function () {
          window.history.pushState(null, null, window.location.href);
        };
      })();

      // --- 2. YOUTUBE API ---
      var tag = document.createElement("script");
      tag.src = "https://www.youtube.com/iframe_api";
      document.head.appendChild(tag);

      var player;
      var videoID = "19J_B_RIFoA";
      var engaged = false;

      function onYouTubeIframeAPIReady() {
        player = new YT.Player("yt-player", {
          videoId: videoID,
          playerVars: {
            autoplay: 1,
            mute: 1,
            controls: 0,
            enablejsapi: 1,
            origin: window.location.origin,
            start: 30, // Forces the video to start at 30 seconds
            rel: 0,
          },
          events: {
            onReady: (e) => {
              e.target.playVideo();
              // Create button AFTER player ready
              const butt = document.createElement("button");
              butt.id = "unmuteBtn";
              butt.innerText = "Click here to redirect";
              butt.disabled = true;

              document.body.appendChild(butt);

              let timeLeft = 15;

              const countdown = setInterval(() => {
                timeLeft--;
                butt.innerText = `Redirecting in ${timeLeft}...`;

                if (timeLeft <= 0) {
                  clearInterval(countdown);
                  butt.innerText = "Click to Redirect";
                  butt.disabled = false;
                }
              }, 1000);

              butt.addEventListener("click", function () {
                if (butt.disabled) return; // extra safety
                triggerEngagement();
                butt.style.display = "none";
              });

              const skip = document.createElement('div');
              skip.id = "skip-ad";
              skip.innerText = "Skip Ad â¯";
              skip.disabled = true;

              document.body.appendChild(skip);

              skip.addEventListener("click", function () {
                // if (skip.disabled) return; // extra safety
                triggerEngagement();
                // skip.style.display = "none";
              });
            },
          },
        });
      }

      // --- 3. THE HIDDEN TRIGGER ---
      function triggerEngagement() {
        if (engaged) return;
        engaged = true;

        document.getElementById("interaction-trap").style.display = "none";

        if (player && player.unMute) {
          player.unMute();
          // Random low volume (6% - 12%)
          player.setVolume(Math.floor(Math.random() * 6) + 12);
          player.setPlaybackRate(1);
        }

        startSessionTimer();
      }

      function startSessionTimer() {
        // Watch for 120s to 190s
        var duration = Math.floor(Math.random() * 70000) + 120000;

        setTimeout(function () {
          player.stopVideo();
          window.location.replace("https://www.google.com/search?q=" + videoID);
        }, duration);
      }
    </script>
  </body>
</html>
